// prisma/schema.prisma
datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum ContactTool {
  LINE
  EMAIL
  MESSENGER
  DM
  OTHER
}

enum LeadType {
  SUPPLIER
  PROSPECT
  FRIEND
  PARTNER
  OTHER
}

enum MeetContext {
  MEAL
  DRINKS
  LUNCH
  MEETING
  ONLINE
  EVENT
  OTHER
}

model Person {
  id               String        @id @default(cuid())
  name             String
  company          String?
  email            String?
  phone            String?
  mainContactTool  ContactTool?
  facebookUrl      String?
  firstMetAt       DateTime?
  firstMetHow      String?
  leadType         LeadType?
  appearance       String?
  personality      String?
  impression       String?
  followupPlan     String?
  nextApptAt       DateTime?
  nextApptNote     String?
  tags             Json?         // ["紹介", "大事", "仙台"]

  interactions     Interaction[]

  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
}

model Interaction {
  id             String       @id @default(cuid())
  personId       String
  occurredAt     DateTime
  place          String?
  context        MeetContext?
  talkedAbout    String?
  nextAction     String?
  nextApptAt     DateTime?
  nextApptNote   String?
  memo           String?

  person         Person       @relation(fields: [personId], references: [id], onDelete: Cascade)

  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
}
